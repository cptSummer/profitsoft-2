# profitsoft-2

У цьому проекті було створено SpringBoot JPA додаток з використанням liquibase та БД PostgreSQL.

## Оновлення сутностей

Оновлено сутності Photo та User для покращення роботи з базою даних

### Сутність Photo

- id integer generated by default as identity constraint photos_pkey primary key,
-  photo_name varchar(100) not null constraint check_photo_name check ((photo_name)::text ~* '^[A-Za-z0-9А-ЩЬЮЯЄІЇа-щьюяєіїҐґ ]{4,}$'::text),
-  photo_format varchar(10)  not null constraint check_photo_format check (length((photo_format)::text) > 0),
-  photo_path varchar(255) not null,
-  photo_description varchar(500) constraint check_description check (length((photo_description)::text) <= 500),
-  photo_tags varchar(500)constraint check_tags check (length((photo_tags)::text) <= 500),
-  upload_date date not null constraint check_upload_date check (upload_date <= '2024-05-02'::date),
-  user_id integer not null constraint fk_photos_to_users references users

Також додано індекс для фільтрації

- create index idx_filter
  on photos (photo_name, photo_format, upload_date);

### Сутність Users

- id integer generated by default as identity constraint users_pkey primary key,
- username varchar(50)  not null constraint check_username check ((username)::text ~* '^[A-Za-z0-9А-ЩЬЮЯЄІЇа-щьюяєіїҐґ ]
  {4,}$'::text),
- password varchar(100) not null,
- email varchar(150) not null constraint users_email_key unique constraint check_email check ((email)::
  text ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$'::text),
- join_date date not null constraint check_join_date check (join_date <= '2024-05-02'::date),
- role varchar(20)  not null constraint check_role check (length((role)::text) > 0)

## Додаткова інформація

Тестові файли знаходяться у [assets](src%2Fmain%2Fresources%2Fassets)

### Створення БД

Для створення бд необхідно виконати sql-запит перед запуском додатку

```sql 
CREATE DATABASE entire_photos;
```

username та password у [application.yml](src%2Fmain%2Fresources%2Fapplication.yml)
змінити відповідно до власних налаштувань

### Помилки у [DefaultService.java](src%2Fmain%2Fjava%2Forg%2Fprofitsoft%2Fprofitsoft2%2Fdatabase%2Fservice%2FDefaultService.java)

Помилки які можуть бути присутні у класі DefaultService не впливають на роботу додатку

### Зміни у [JsonParser.java](src%2Fmain%2Fjava%2Forg%2Fprofitsoft%2Fprofitsoft2%2Futils%2Fjson%2FJsonParser.java)

До JSON парсеру були додані JavaDoc для пояснення роботи. Також було змінено структуру парсеру щоб була можливість
додавання
null значень (помилкових об'єктів) до кінечного списку і подальшої їх обробки. Змінено спосіб парсингу об'єктів з явного
на підставлення під підходящі значення відповідно до атрибутів(Додатково зроблено обробку сутності Users для Photo по
user_id)

### Поодальші можливі зміни

- Додавання обробки зберігання у хмарному сховищі
- Збілшення кількості таблиць для покращення реалізації додатку (приклад: таблиця коментарів)
- Покращення зберігання даних сутності фото за допомогою функцій у бд
- Додавання тригерів до бази даних щоб покращити продуктивність
- Покращення валідації полів сутностей

### Приклад файлу репорту
[report.xlsx](src%2Fmain%2Fresources%2Fassets%2Freport.xlsx)



